// Ajatix Image/Banner Rotator
// Copyright (C) 2011-2012 Ajatix. All rights reserved.
// http://www.ajatix.com
(function(){var d=document, de=d.documentElement, IE=document.all&&!window.opera, IE6=IE&&!window.XMLHttpRequest;function createDiv(id, parent){var div=d.createElement('div');div.id=id;parent.appendChild(div);return div;}function onLoad(){var listIR=new Array();var on='AJXIRMdICLIA';function showPics(id,num){var m=listIR[id];if(m.ncur===num)return true;if(m.ncur>=0){m.imgf.src=m.imgs[m.ncur].src;m.imgf.alt=m.imgs[m.ncur].alt;m.divf.style.display='block';m.ulPics.style.display='none';m.lis[1].innerHTML=m.liPics[m.ncur];}else{m.lis[1].innerHTML=m.liPics[num];}m.lis[0].innerHTML=m.liPics[num];m.ulPics.style.right=0+'px';var endP=-444;m.ulPics.style.display='block';m.divf.style.display='none';if(m.ncur>-1){moveTo([[m.ulPics,{right:endP}]],1000);}m.n=num;m.ncur=num;};function autoShow(){for(var id in listIR){var m=listIR[id];if(m.autoP){if(m.n==m.imgs.length-1){m.n=0;}else{++m.n;}if(m.n<=m.liPics.length-1){unselBtn(id);m.liBtn[m.n].className='current';showPics(id,m.n);}}}};function unselBtn(id){for(var k=0;k<listIR[id].liBtn.length;k++){listIR[id].liBtn[k].className='';}}var autoT=null;var divs=d.getElementsByTagName('div');for(var i=0;i<divs.length;i++){if(divs[i].className==on){var obj=new Object;obj.autoP=true;obj.n=-1;obj.ncur=-1;obj.id='id'+i;divs[i]._id=obj.id;obj.imgs=new Array();obj.liPics=new Array();obj.lis=new Array();var liPics=new Array();var ulPics=divs[i].getElementsByTagName('ul')[0];{var lis=ulPics.getElementsByTagName('li');var iLi=0;for(var j=0;j<lis.length;j++){if(lis[j].className.indexOf(on+'li')>=0){liPics[iLi++]=lis[j];}}}var cnt=liPics.length;for(var j=0;j<cnt;j++){obj.imgs[j]=liPics[j].getElementsByTagName('img')[0];}obj.divf=createDiv('',divs[i].getElementsByTagName('div')[0]);obj.divf.className=on+'forwardpic';obj.imgf=d.createElement('img');obj.imgf.className=on+'img';obj.imgf.src=obj.imgs[0].src;obj.imgf.alt=obj.imgs[0].alt;obj.divf.appendChild(obj.imgf);obj.divf.style.display='block';var newUl=d.createElement('ul');newUl.className=on+'ul';for(var j=0;j<2;++j){var li=d.createElement('li');li.className=on+'li';newUl.appendChild(li);obj.lis[j]=li;}var wid=divs[i].getElementsByTagName('div')[0].offsetWidth;newUl.style.width=wid*2+'px';ulPics.parentNode.appendChild(newUl);for(var j=0;j<liPics.length;++j){obj.liPics[j]=liPics[j].innerHTML;}ulPics.parentNode.removeChild(ulPics);obj.ulPics=newUl;var btndiv=createDiv('', divs[i]);btndiv.className=on+'btn';var s='<ul>';for(var l=0;l<cnt;l++){s+='<li>'+'</li>'}s+='</ul>';btndiv.innerHTML=s;obj.ulBtn=btndiv.getElementsByTagName('ul')[0];obj.liBtn=obj.ulBtn.getElementsByTagName('li');for(var k=0;k<obj.liBtn.length;k++){obj.liBtn[k].I=k;obj.liBtn[k]._id=obj.id;obj.liBtn[k].onmouseover=function(){var o=this;o.timer=setTimeout(function(){unselBtn(o._id);o.className='current';showPics(o._id,o.I);}, 300);};obj.liBtn[k].onmouseout=function(){if(this.timer)clearTimeout(this.timer);};}listIR[obj.id]=obj;divs[i].onmouseover=function(){listIR[this._id].autoP=false;var ct=false;for(var id in listIR){ct=ct||listIR[id].autoP;}if(!ct){clearInterval(autoT);autoT=null;}};divs[i].onmouseout=function(){listIR[this._id].autoP=true;if(autoT==null)autoT=setInterval(autoShow,4000);};var br=d.createElement('br');divs[i].appendChild(br);}}autoShow();autoT=setInterval(autoShow,4000);function moveTo(pairs, speed, f){var oldpos=new Array;for(var i=0;i<pairs.length;i++){oldpos[i]=new Object;for(var n in pairs[i][1])oldpos[i][n]=parseInt(pairs[i][0].style[n]);}var tstart=new Date;if(!speed)speed=1000;var e=pairs[0][0];if(e.mtimer)clearInterval(e.mtimer);e.mtimer=setInterval(function(){var s=(new Date-tstart)/speed;if(s>1)s=1;var v=((-Math.cos(s*Math.PI)/2)+0.5);for(var i=0;i<pairs.length;i++){for(var n in pairs[i][1])pairs[i][0].style[n]=Math.floor((pairs[i][1][n]-oldpos[i][n])*v)+oldpos[i][n]+'px';}if(s==1){clearInterval(e.mtimer);if(f)f();}}, 15);};};function addOnReady(f,fu){var isReady=false,ready=function(){if(!isReady){isReady=true;f();};};if(d.addEventListener){d.addEventListener('DOMContentLoaded',ready,false);window.addEventListener('load',ready,false);}if(window.attachEvent)window.attachEvent('onload',ready);if(d.documentElement.doScroll&&window==top){(function(){if(!isReady){try{d.documentElement.doScroll('left');}catch(E){setTimeout(arguments.callee,0);return;}ready();}})()}}addOnReady(onLoad, onLoad);})();